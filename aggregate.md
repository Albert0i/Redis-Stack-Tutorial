
Example 1: Basic Aggregation

Suppose we have an index named "products" that contains documents representing different products. Each product document has fields like "name," "category," and "price." We want to aggregate the data to calculate the average price of products in each category.

```
FT.AGGREGATE products "*" GROUPBY 1 @category REDUCE AVG 1 @price AS avg_price
```

In this example, we use the FT.AGGREGATE command to perform the aggregation. The "*" query parameter matches all documents in the "products" index. We group the results by the "category" field (GROUPBY 1 @category) and calculate the average price of products in each category (REDUCE AVG 1 @price AS avg_price).

The resulting aggregated data might look like this:

```
+---------------+-------------------+
|   category    |     avg_price     |
+---------------+-------------------+
|   Electronics |      499.99       |
|   Clothing    |      79.99        |
|   Books       |      29.99        |
|   Furniture   |      299.99       |
|   ...         |      ...          |
+---------------+-------------------+
```

This example demonstrates how FT.AGGREGATE can be used to calculate aggregate values, such as average prices, based on specific grouping criteria.

Example 2: Aggregation with Sorting and Limiting

Let's consider a scenario where we want to find the top 5 most expensive products in the "products" index.

```
FT.AGGREGATE products "*" SORTBY 1 @price DESC LIMIT 5
```

Here, we perform the FT.AGGREGATE command on the "products" index, using the "*" query parameter to match all documents. We sort the results based on the "price" field in descending order (SORTBY 1 @price DESC) and limit the output to the top 5 results (LIMIT 5).

The resulting aggregated data might look like this:

```
+------------------+-------+
|       name       | price |
+------------------+-------+
|  Product A       | 599.99|
|  Product B       | 549.99|
|  Product C       | 499.99|
|  Product D       | 479.99|
|  Product E       | 459.99|
+------------------+-------+
```

In this example, we obtain the top 5 most expensive products based on their prices, demonstrating how FT.AGGREGATE can be used to sort and limit the aggregated results.

Example 3: Aggregation with Multiple Grouping Fields

Let's assume we have an index named "orders" that contains documents representing customer orders. Each order document has fields like "customer_id," "product_id," and "quantity." We want to aggregate the data to calculate the total quantity of products ordered by each customer, grouped by both "customer_id" and "product_id."

```
FT.AGGREGATE orders "*" GROUPBY 2 @customer_id @product_id REDUCE SUM 1 @quantity AS total_quantity
```

In this example, we use the FT.AGGREGATE command on the "orders" index, matching all documents with the "*" query parameter. We group the results by both "customer_id" and "product_id" (GROUPBY 2 @customer_id @product_id) and calculate the sum of quantities ordered for each combination (REDUCE SUM 1 @quantity AS total_quantity).

The resulting aggregated data might look like this:

```
+--------------+------------+------------------+
| customer_id  | product_id | total_quantity   |
+--------------+------------+------------------+
|   Customer1  |   Product1 |      10          |
|   Customer1  |   Product2 |      5           |
|   Customer2  |   Product1 |      8           |
|   Customer2  |   Product3 |      12          |
|   ...        |   ...      |      ...         |
+--------------+------------+------------------+
```

In this example, we obtain the total quantity of products ordered by each customer, grouped by both "customer_id" and "product_id," showcasing the capability of FT.AGGREGATE to perform aggregations with multiple grouping fields.

These examples highlight the versatility and power of the FT.AGGREGATE command in Redisearch. It allows you to perform complex aggregations on indexed data, enabling you to analyze and summarize information based on specific criteria. Whether it's calculating averages, finding top values, or performing multi-level grouping, FT.AGGREGATE provides a flexible and efficient way to extract meaningful insights from your data.


Explain FT.AGGREGATE with examples (Generated by ChatGPT)
