Subject
Local government is planning to provide lodgings for low-input families. Based on a pre-defined formula, rent is calculated according to economic situation as well as physical condition of indivisuals. A periodical random inspection is done to verify and re-calculation of rent is performed whenever necessary. 

I. Sample data (Generated by ChatGPT)

1. 
JSON.SET rentals:240031:001 $
    '{
        "rentNo": "240031",
        "location": {
            "building": "AS-1",
            "flat": "15F"
        },
        "rent": 35.5,
        "startDate": 19990601,
        "endDate": 20240531,
        "status": "active",
        "remark": "Father recovered from the car accident. Mother continues working the night shift at the supermarket. Son enjoys playing football and is doing well in school.",
        "members": [
            {"memseq": 1, "name": "Jose Madox", "post": "father", "gender": "male", "birthday": 19620320},
            {"memseq": 2, "name": "Maria Sousa", "post": "mother", "gender": "female", "birthday": 19680703},
            {"memseq": 3, "name": "Paulo Madox", "post": "son", "gender": "male", "birthday": 19911017}
        ],
        "updateBy": "BOB",
        "updateAt": 20220820
    }'

2. 
JSON.SET rentals:240077:001 $
    '{
        "rentNo": "240077",
        "location": {
            "building": "AS-2",
            "flat": "10C"
        },
        "rent": 42.8,
        "startDate": 20040115,
        "endDate": 20240630,
        "status": "active",
        "remark": "The family recently moved to a new apartment. Father works full-time, mother is a homemaker, and the daughter is studying in college.",
        "members": [
            {"memseq": 1, "name": "John Smith", "post": "father", "gender": "male", "birthday": 19750210},
            {"memseq": 2, "name": "Emily Smith", "post": "mother", "gender": "female", "birthday": 19800225},
            {"memseq": 3, "name": "Sophia Smith", "post": "daughter", "gender": "female", "birthday": 20011005}
        ],
        "updateBy": "ALICE",
        "updateAt": 20240312
    }'

3. 
JSON.SET rentals:240025:001 $
    '{
        "rentNo": "240025",
        "location": {
            "building": "AS-3",
            "flat": "5A"
        },
        "rent": 28.9,
        "startDate": 20100120,
        "endDate": 20241231,
        "status": "active",
        "remark": "The family enjoys outdoor activities together. Both parents work during the day, and their son is studying in high school.",
        "members": [
            {"memseq": 1, "name": "David Johnson", "post": "father", "gender": "male", "birthday": 19800815},
            {"memseq": 2, "name": "Sarah Johnson", "post": "mother", "gender": "female", "birthday": 19820628},
            {"memseq": 3, "name": "Michael Johnson", "post": "son", "gender": "male", "birthday": 20040910}
        ],
        "updateBy": "LISA",
        "updateAt": 20240318
    }'

4. 
JSON.SET rentals:240012:001 $
    '{
        "rentNo": "240012",
        "location": {
            "building": "AS-4",
            "flat": "3B"
        },
        "rent": 31.2,
        "startDate": 20071005,
        "endDate": 20240630,
        "status": "active",
        "remark": "The family recently adopted a puppy. Father works remotely, mother is a teacher, and their daughter is in primary school.",
        "members": [
            {"memseq": 1, "name": "Robert Davis", "post": "father", "gender": "male", "birthday": 19830518},
            {"memseq": 2, "name": "Jennifer Davis", "post": "mother", "gender": "female", "birthday": 19850207},
            {"memseq": 3, "name": "Emma Davis", "post": "daughter", "gender": "female", "birthday": 20100325}
        ],
        "updateBy": "MIKE",
        "updateAt": 20240322
    }'

5. 
JSON.SET rentals:240033:001 $
    '{
        "rentNo": "240033",
        "location": {
            "building": "AS-5",
            "flat": "8D"
        },
        "rent": 37.1,
        "startDate": 20020101,
        "endDate": 20240630,
        "status": "active",
        "remark": "The family loves cooking together. Both parents work from home, and their two children are in elementary school.",
        "members": [
            {"memseq": 1, "name": "Daniel Brown", "post": "father", "gender": "male", "birthday": 19841012},
            {"memseq": 2, "name": "Jessica Brown", "post": "mother", "gender": "female", "birthday": 19860827},
            {"memseq": 3, "name": "Oliver Brown", "post": "son", "gender": "male", "birthday": 20110103},
            {"memseq": 4, "name": "Sophie Brown", "post": "daughter", "gender": "female", "birthday": 20130318}
        ],
        "updateBy": "EMMA",
        "updateAt": 20240325
    }'

6. 
JSON.SET rentals:240008:001 $
    '{
        "rentNo": "240008",
        "location": {
            "building": "AS-6",
            "flat": "12B"
        },
        "rent": 42.5,
        "startDate": 20091210,
        "endDate": 20241231,
        "status": "active",
        "remark": "The family enjoys hiking on weekends. Father is a doctor, mother is a lawyer, and their two children are in high school.",
        "members": [
            {"memseq": 1, "name": "Andrew Wilson", "post": "father", "gender": "male", "birthday": 19790905},
            {"memseq": 2, "name": "Emily Wilson", "post": "mother", "gender": "female", "birthday": 19810719},
            {"memseq": 3, "name": "Matthew Wilson", "post": "son", "gender": "male", "birthday": 20010930},
            {"memseq": 4, "name": "Sophia Wilson", "post": "daughter", "gender": "female", "birthday": 20040312}
        ],
        "updateBy": "JAMES",
        "updateAt": 20240324
    }'

7. 
JSON.SET rentals:240123:001 $
    '{
        "rentNo": "240123",
        "location": {
            "building": "AS-7",
            "flat": "4C"
        },
        "rent": 29.8,
        "startDate": 20150105,
        "endDate": 20240630,
        "status": "active",
        "remark": "The family enjoys gardening. Both parents work full-time, and their son is studying in college.",
        "members": [
            {"memseq": 1, "name": "Christopher Anderson", "post": "father", "gender": "male", "birthday": 19740615},
            {"memseq": 2, "name": "Melissa Anderson", "post": "mother", "gender": "female", "birthday": 19780222},
            {"memseq": 3, "name": "Daniel Anderson", "post": "son", "gender": "male", "birthday": 19961208}
        ],
        "updateBy": "SOPHIA",
        "updateAt": 20240318
    }'

8. 
JSON.SET rentals:240049:001 $
    '{
        "rentNo": "240049",
        "location": {
            "building": "AS-8",
            "flat": "6A"
        },
        "rent": 33.2,
        "startDate": 20120330,
        "endDate": 20241231,
        "status": "active",
        "remark": "The family recently moved to a new city. Both parents are freelancers, and their daughter is attending a local school.",
        "members": [
            {"memseq": 1, "name": "William Thompson", "post": "father", "gender": "male", "birthday": 19861008},
            {"memseq": 2, "name": "Victoria Thompson", "post": "mother", "gender": "female", "birthday": 19891217},
            {"memseq": 3, "name": "Emma Thompson", "post": "daughter", "gender": "female", "birthday": 20140122}
        ],
        "updateBy": "DAVID",
        "updateAt": 20240323
    }'

9. 
JSON.SET rentals:240026:001 $
    '{
        "rentNo": "240026",
        "location": {
        "building": "AS-8",
        "flat": "6A"
        },
        "rent": 33.2,
        "startDate": 20120330,
        "endDate": 20241231,
        "status": "active",
        "remark": "The family recently moved to a new city. Both parents are freelancers, and their daughter is attending a local school.",
        "members": [
        {"memseq": 1, "name": "William Thompson", "post": "father", "gender": "male", "birthday": 19861008},
        {"memseq": 2, "name": "Victoria Thompson", "post": "mother", "gender": "female", "birthday": 19891217},
        {"memseq": 3, "name": "Emma Thompson", "post": "daughter", "gender": "female", "birthday": 20140122}
        ],
        "updateBy": "DAVID",
        "updateAt": 20240323
    }'

10. 
JSON.SET rentals:240113:001 $
    '{
        "rentNo": "240113",
        "location": {
            "building": "AS-10",
            "flat": "7E"
        },
        "rent": 39.9,
        "startDate": 20180315,
        "endDate": 20240630,
        "status": "active",
        "remark": "The family enjoys traveling together. Both parents work during the day, and their two children are in middle school.",
        "members": [
            {"memseq": 1, "name": "Michael Johnson", "post": "father", "gender": "male", "birthday": 19791205},
            {"memseq": 2, "name": "Jennifer Johnson", "post": "mother", "gender": "female", "birthday": 19810318},
            {"memseq": 3, "name": "Ethan Johnson", "post": "son", "gender": "male", "birthday": 20060210},
            {"memseq": 4, "name": "Sophia Johnson", "post": "daughter", "gender": "female", "birthday": 20090123}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'

11. 
JSON.SET rentals:240005:001 $
    '{
        "rentNo": "240005",
        "location": {
            "building": "D-12",
            "flat": "3B"
        },
        "rent": 45.0,
        "startDate": 20210110,
        "endDate": 20211231,
        "status": "active",
        "remark": "Member 1: Recovering from a leg injury. Member 2: Requires regular physical therapy for back pain.",
        "members": [
            {"memseq": 1, "name": "John Smith", "post": "father", "gender": "male", "birthday": 19851020},
            {"memseq": 2, "name": "Emily Smith", "post": "mother", "gender": "female", "birthday": 19871215},
            {"memseq": 3, "name": "Oliver Smith", "post": "son", "gender": "male", "birthday": 20140903}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'

12. 
JSON.SET rentals:240015:001 $
    '{
        "rentNo": "240015",
        "location": {
            "building": "C-5",
            "flat": "2A"
        },
        "rent": 36.5,
        "startDate": 20220105,
        "endDate": 20221231,
        "status": "active",
        "remark": "Member 1: Requires a wheelchair due to paralysis. Member 2: Has visual impairment.",
        "members": [
            {"memseq": 1, "name": "David Johnson", "post": "father", "gender": "male", "birthday": 19760912},
            {"memseq": 2, "name": "Sarah Johnson", "post": "mother", "gender": "female", "birthday": 19800228},
            {"memseq": 3, "name": "Emma Johnson", "post": "daughter", "gender": "female", "birthday": 20100317}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'

13. 
JSON.SET rentals:240037:001 $
    '{
        "rentNo": "240037",
        "location": {
            "building": "B-8",
            "flat": "4C"
        },
        "rent": 42.8,
        "startDate": 20230618,
        "endDate": 20240630,
        "status": "active",
        "remark": "Member 1: Recovering from a recent surgery. Member 2: Requires a hearing aid.",
        "members": [
            {"memseq": 1, "name": "Michael Davis", "post": "father", "gender": "male", "birthday": 19820108},
            {"memseq": 2, "name": "Jessica Davis", "post": "mother", "gender": "female", "birthday": 19830522},
            {"memseq": 3, "name": "Noah Davis", "post": "son", "gender": "male", "birthday": 20120409},
            {"memseq": 4, "name": "Sophie Davis", "post": "daughter", "gender": "female", "birthday": 20150831}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'

14. 
JSON.SET rentals:240073:001 $
    '{
        "rentNo": "240073",
        "location": {
            "building": "A-3",
            "flat": "1D"
        },
        "rent": 55.2,
        "startDate": 20200401,
        "endDate": 20250331,
        "status": "active",
        "remark": "Member 1: Uses a walking cane due to arthritis. Member 2: Has a heart condition.",
        "members": [
            {"memseq": 1, "name": "Robert Wilson", "post": "father", "gender": "male", "birthday": 19591217},
            {"memseq": 2, "name": "Karen Wilson", "post": "mother", "gender": "female", "birthday": 19630220},
            {"memseq": 3, "name": "Daniel Wilson", "post": "son", "gender": "male", "birthday": 19900508},
            {"memseq": 4, "name": "Lily Wilson", "post": "daughter", "gender": "female", "birthday": 19940723}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'

15. 
JSON.SET rentals:240177:001 $
    '{
        "rentNo": "240177",
        "location": {
            "building": "AS-10",
            "flat": "7E"
        },
        "rent": 39.9,
        "startDate": 20180315,
        "endDate": 20240630,
        "status": "active",
        "remark": "The family enjoys traveling together. Both parents work during the day, and their two children are in middle school.",
        "members": [
            {"memseq": 1, "name": "Michael Johnson", "post": "father", "gender": "male", "birthday": 19791205},
            {"memseq": 2, "name": "Jennifer Johnson", "post": "mother", "gender": "female", "birthday": 19810318},
            {"memseq": 3, "name": "Ethan Johnson", "post": "son", "gender": "male", "birthday": 20060210},
            {"memseq": 4, "name": "Sophia Johnson", "post": "daughter", "gender": "female", "birthday": 20090123}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'

16. 
JSON.SET rentals:240032:001 $
    '{
        "rentNo": "240032:006",
        "location": {
            "building": "E-6",
            "flat": "5D"
        },
        "rent": 48.7,
        "startDate": 20230115,
        "endDate": 20240630,
        "status": "active",
        "remark": "Member 1: Recovering from a broken arm. Member 2: Requires regular medication for asthma.",
        "members": [
            {"memseq": 1, "name": "Andrew Thompson", "post": "father", "gender": "male", "birthday": 19890402},
            {"memseq": 2, "name": "Sophie Thompson", "post": "mother", "gender": "female", "birthday": 19910623},
            {"memseq": 3, "name": "Jacob Thompson", "post": "son", "gender": "male", "birthday": 20150214}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'

17. 
JSON.SET rentals:240170:001 $
    '{
        "rentNo": "240170",
        "location": {
            "building": "F-9",
            "flat": "2B"
        },
        "rent": 42.0,
        "startDate": 20220101,
        "endDate": 20221231,
        "status": "active",
        "remark": "Member 1: Recovering from a recent surgery. Member 2: Requires a wheelchair for mobility.",
        "members": [
            {"memseq": 1, "name": "William Davis", "post": "father", "gender": "male", "birthday": 19830510},
            {"memseq": 2, "name": "Olivia Davis", "post": "mother", "gender": "female", "birthday": 19840827},
            {"memseq": 3, "name": "Ava Davis", "post": "daughter", "gender": "female", "birthday": 20100603}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'

18. 
JSON.SET rentals:240125:001 $
    '{
        "rentNo": "240125",
        "location": {
            "building": "G-2",
            "flat": "3C"
        },
        "rent": 55.5,
        "startDate": 20200110,
        "endDate": 20211231,
        "status": "active",
        "remark": "Member 1: Requires a walking aid due to a hip injury. Member 2: Has a visual impairment.",
        "members": [
            {"memseq": 1, "name": "James Wilson", "post": "father", "gender": "male", "birthday": 19770214},
            {"memseq": 2, "name": "Emma Wilson", "post": "mother", "gender": "female", "birthday": 19791231},
            {"memseq": 3, "name": "Liam Wilson", "post": "son", "gender": "male", "birthday": 20130520},
            {"memseq": 4, "name": "Olivia Wilson", "post": "daughter", "gender": "female", "birthday": 20161207}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'

19. 
JSON.SET rentals:240088:001 $
    '{
        "rentNo": "240088",
        "location": {
            "building": "H-5",
            "flat": "4A"
        },
        "rent": 49.9,
        "startDate": 20220305,
        "endDate": 20230331,
        "status": "active",
        "remark": "Member 1: Uses a wheelchair due to paralysis. Member 2: Has a hearing impairment.",
        "members": [
            {"memseq": 1, "name": "Benjamin Anderson", "post": "father", "gender": "male", "birthday": 19710818},
            {"memseq": 2, "name": "Emily Anderson", "post": "mother", "gender": "female", "birthday": 19740802},
            {"memseq": 3, "name": "Sophia Anderson", "post": "daughter", "gender": "female", "birthday": 20091011}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'

20. 
JSON.SET rentals:240163:001 $
    '{
        "rentNo": "240163",
        "location": {
            "building": "I-8",
            "flat": "6B"
        },
        "rent": 58.2,
        "startDate": 20230101,
        "endDate": 20231231,
        "status": "active",
        "remark": "Member 1: Recovering from a knee surgery. Member 2: Requires a hearing aid.",
        "members": [
            {"memseq": 1, "name": "Christopher Brown", "post": "father", "gender": "male", "birthday": 19800608},
            {"memseq": 2, "name": "Olivia Brown", "post": "mother", "gender": "female", "birthday": 19810425},
            {"memseq": 3, "name": "Mason Brown", "post": "son", "gender": "male", "birthday": 20120413},
            {"memseq": 4, "name": "Chloe Brown", "post": "daughter", "gender": "female", "birthday": 20150929}
        ],
        "updateBy": "OLIVIA",
        "updateAt": 20240325
    }'


II. Indexing the documents 
FT.CREATE rentals:index ON 
    JSON PREFIX 1 rentals: SCHEMA 
    $.rentNo AS rentNo TAG 
    $.location.building AS building TAG 
    $.location.flat AS flat TAG 
    $.rent AS rent NUMERIC 
    $.startDate AS startDate NUMERIC 
    $.endDate AS endDate NUMERIC 
    $.status AS status TAG 
    $.remark AS remark TEXT WEIGHT 3.0 
    $.members[*].memseq as memseq NUMERIC
    $.members[*].name as name TEXT WEIGHT 3.0 
    $.members[*].post as post TAG
    $.members[*].gender as gender TAG
    $.members[*].birthday as birthday NUMERIC
    $.updateBy AS updateBy TAG
    $.updateAt AS updateAt NUMERIC 


III. Search 
To list all families (not recommended):
    FT.search rentals:index * 

To search for all family keys (not recommended): 
    keys rentals:* 

To search for first 100 family keys:
    scan 0 match rentals:* count 100

To search for family 240005:
    FT.search rentals:index @rentNo:{240005}

To get indivisual family:
    JSON.GET rentals:240005:001

To make a full text search for "walking cane":
    ft.search rentals:index "walking cane"

To make a full text search on remark field for "walking cane":
    ft.search rentals:index '@remark:("walking cane")'

To search for families with rent 50 to 100 (inclusive):
    ft.search rentals:index '@rent:[50 100]'

To search for families with rent 50 to 100 (not inclusive):
    ft.search rentals:index '@rent:[(50 (100]'

To search for all active families:    
    ft.search rentals:index @status:{active}

To search for families which lived in building AS-1, AS-2 and AS-3:
    ft.search rentals:index @building:{as\-1|as\-2|as\-3}

To search for families which lived in in flat "5A":
    ft.search rentals:index @flat:{5a}

To make a full text search for "william":
    ft.search rentals:index william

To make a full text search on name field for "william":
    ft.search rentals:index @name:(william)

To search for female and birthed in 1974:
    ft.search rentals:index '@birthday:[19740101 19741231] @gender:{female}'

To search for families updated by operator Alice: 
    ft.search rentals:index @updateBy:{alice}


IV. Aggregate 


EOF (2024/03/25)